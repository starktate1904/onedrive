{% extends 'dashboard/admin_dashboard.html' %}
{% block content %}



<!-- page title -->
<div class="pagetitle">
    <h1 class="h5 mb-0 font-weight-bold text-black-800 text-primary text-uppercase mb-1">Branches</h1>
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'auth_pos:admin_dashboard' %}">Home</a></li>
        <li class="breadcrumb-item"><a href="{% url 'branches:branch_list' %}">Branches</a></li>
      </ol>
    </nav>
</div><!-- End Page Title -->




<!-- page indoc styling  -->
<style>

    .breadcrumb{

        background-color: white;
        border-radius: 30px;
    }

    .pagetitle{

        margin-right: 20px;
        margin-left: 20px;
        


    }
    #noBranchCard{

        border-radius: 30px;
        margin-bottom: 20px;


    }



    #branchMainCard{

        margin-bottom: 30px;
        border-radius: 30px;
        margin-left: 20px;
        margin-right: 20px;
        


    }
    #BranchCard{

        margin-top: 30px;
        margin-left: 30px;
        margin-right: 30px;
        margin-bottom: 30px;

    }
    #addbranchBtn{

        
        margin-right: 30px;
        border-radius: 10px;
        margin-left: 30px;
        margin-top: 30px;
        margin-bottom: 30px;
        


    }
   

</style>
<!-- end styling -->





<!-- branch list in cards -->
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
<div class="card" id="branchMainCard">
  <div id="branchlistbtns">
    <button type="button" class="btn btn-success " id="addbranchBtn" data-bs-toggle="modal" data-bs-target="#branchModal"><i class="fas fa-building  fa-sm fa-fw mr-2 text-black-300"></i>Add Branch</button>
  </div>
  {% if  not branches %}
  <div class="col-lg-12">
    <div class="card bg-warning" id="noBranchCard">
      <div class="card-body">
        <h5 class="card-title">No Branches found!</h5>
        <p class="card-text">You can add a new branch by clicking on the "<b><i class="fas fa-plus"></i>Add Branch</b>" button.</p>
      </div>
    </div>
  </div>
  {% else %}
  <div class="row">
    {% for branch in branches %}
      <div class="col-xl-3 col-md-6 mb-4" id="BranchCard">
        <div class="card border-left-warning shadow h-100 py-2">
          <div class="card-body">
            <div class="row no-gutters align-items-center">
              <div class="col mr-2">
                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">Name: <b>{{ branch.name }}</b></div>
                <div class="h5 mb-0 font-weight-bold text-black-800">location: <b>{{ branch.location }}</b></div>
              </div>
              <div class="col-auto">
                <i class="fas fa-building fa-2x text-black-300"></i>
              </div>
            </div>
          </div>
          <div class="card-footer justify-content-center">
            <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#viewDetailsModal{{ branch.id }}">View Details</button>
            <a href="{% url 'branches:branch_products' branch.id %}"  class="btn btn-warning btn-sm" >Inventory</a>
            <a href="{% url 'branches:branch_update' branch.id %}" data-bs-toggle="modal" data-bs-target="#editBranch-{{forloop.counter}}" class="btn btn-warning btn-sm">Edit</a>
            <a href="{% url 'branches:branch_delete' branch.id %}" data-bs-toggle="modal" data-bs-target="#deleteBranch-{{forloop.counter}}" class="btn btn-danger btn-sm">Delete</a>
         
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
  {% endif %}
</div>
</div>
<!-- end branch list -->



<!-- branch details  modal -->
{% for branch in branches %}
<div class="modal fade" id="viewDetailsModal{{ branch.id }}" tabindex="-1" >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header" > 
        </div>
        <div class="modal-body"  >
            {{branch.name}}
        </div>
        <div class="modal-footer"  >
          <button type="button" class="btn btn-danger rounded-pill" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
</div>
{% endfor %}
<!-- end branch deatils modal -->




<!-- branch creation modal -->
<div class="modal fade" id="branchModal" tabindex="-1" >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header" > 
          </div>
          <!-- branch creation form -->
          <div class="modal-body"  >
            <form class="user" method="POST" action="{% url 'branches:branch_create' %}">
                {% csrf_token %}
                    <div class="form-group row">
                        <div class="col-sm-6 mb-3 mb-sm-0">
                            <input type="text" class="form-control form-control-user" id="exampleFirstName"
                                placeholder="Branch Name" name="name">
                        </div>
                        <div class="col-sm-6">
                            <input type="text" class="form-control form-control-user" id="exampleLastName"
                                placeholder="Branch Location" name="location">
                        </div>
                    </div>
                    <button  class="btn btn-primary btn-user btn-block" type="submit" >
                        Create Branch
                    </button>  
            </form>
          </div>
          <div class="modal-footer"  >
            <button type="button" class="btn btn-danger rounded-pill" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
</div>
<!-- end branch creation modal -->



<!-- Edit branch Modal HTML -->
 {% for branch in branches %}
<div id="editBranch-{{forloop.counter}}" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form method="POST" action="{% url 'branches:save_update_branch'  %}" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="modal-header">						
                    <h4 class="modal-title">Edit <b>{{branch.name}}</b> Branch</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">					
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" class="form-control" name="name" value="{{ branch.name }}" required>
                        <input type="text" class="form-control" name="id" value="{{ branch.id }}" hidden>
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" class="form-control"  name='location' value="{{ branch.location }}" required>
                    </div>			
                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-info" value="Save">
                </div>
            </form>
        </div>
    </div>
</div>
{% endfor %}
<!-- end edit branch modal -->


<!-- Delete Branch Modal HTML -->
{% for branch in branches %}
<div id="deleteBranch-{{forloop.counter}}" class="modal fade">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <form action="{% url 'branches:branch_delete' branch.id %}" method="post">
                {% csrf_token %}
                <div class="modal-header">						
                    <h4 class="modal-title">Delete <b>{{branch.name}}</b> Branch</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body text-center">					
                    <p>Are you sure you want to delete this branch</p>
                    <p class="text-warning text-center"><small>This action cannot be undone.</small></p>
                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-default-warning" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-danger" value="Delete">
                </div>
            </form>
        </div>
    </div>
</div>
{% endfor %}
<!-- end delete branch modal -->
  

{% endblock content%}